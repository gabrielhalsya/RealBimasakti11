@page "/PMT05000"
@inherits R_Page

<R_StackLayout>
    <R_ItemLayout>
        <R_Label FontStyle="R_eFontStyle.Bold" FontColor="R_eFontColor.Danger">PROPERTY</R_Label>
    </R_ItemLayout>
    <R_ItemLayout col="3" Class="ms-1">
        <R_DropDownList Data="@_agreementChrgDiscViewModel._PropertyList"
                        Value="@_agreementChrgDiscViewModel._AgreementChrgDiscProcessParam.CPROPERTY_ID"
                        ValueField="@nameof(PropertyDTO.CPROPERTY_ID)"
                        TextField="@nameof(PropertyDTO.CPROPERTY_NAME)"
                        ValueChanged="@((string value) => ComboboxPropertyValueChanged(value))"
                        Enabled="@_comboboxPropertyEnabled">
        </R_DropDownList>
    </R_ItemLayout>
</R_StackLayout>

<R_TabStrip @ref="_tabStripAgrChrgDisc">
    <R_TabStripTab Title="@_localizer["_tabApplyDisc"]" id="@nameof(PMT05000)">

        @* charge *@
        <R_StackLayout Row>
            <R_ItemLayout col="2">
                <R_Label>@_localizer["_labelChargeType"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_ComboBox Data="@_agreementChrgDiscViewModel._ChargeTypeList"
                            @bind-Value="@_agreementChrgDiscViewModel._AgreementChrgDiscProcessParam.CCHARGES_TYPE"
                            ValueField="@nameof(GSB_CodeInfoDTO.CCODE)"
                            TextField="@nameof(GSB_CodeInfoDTO.CDESCRIPTION)" />
            </R_ItemLayout>
            <R_ItemLayout col="1"></R_ItemLayout>
            <R_ItemLayout col="1">
                <R_Label>@_localizer["_labelCharge"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_TextBox @bind-Value="_agreementChrgDiscViewModel._AgreementChrgDiscProcessParam.CCHARGES_ID"
                           R_ConductorSource="_conAgrChrgDisc"
                           Enabled="true"
                           MaxLength="int.MaxValue"
                           OnLostFocus="OnLostFocus_LookupUnitChargesAsync"
                           TabIndex="1" />
            </R_ItemLayout>
            <R_ItemLayout>
                <R_Lookup R_ConductorSource="_conAgrChrgDisc" R_Before_Open_Lookup="@BeforeOpen_lookupUnitCharges" R_After_Open_Lookup="@AfterOpen_lookupUnitChargesAsync" TabIndex="2">...</R_Lookup>
            </R_ItemLayout>
            <R_ItemLayout>
                <R_TextBox @bind-Value="_agreementChrgDiscViewModel._chargesName" Enabled="false"></R_TextBox>
            </R_ItemLayout>
        </R_StackLayout>

        @* discount *@
        <R_StackLayout Row>
            <R_ItemLayout col="1">
                <R_Label>@_localizer["_labelDiscount"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout col="2">
                <R_TextBox @bind-Value="_agreementChrgDiscViewModel._AgreementChrgDiscProcessParam.CDISCOUNT_CODE"
                           R_ConductorSource="_conAgrChrgDisc"
                           Enabled="true"
                           MaxLength="int.MaxValue"
                           OnLostFocus="OnLostFocus_LookupDiscountAsync"
                           TabIndex="1" />
            </R_ItemLayout>
            <R_ItemLayout>
                <R_Lookup R_ConductorSource="_conAgrChrgDisc" R_Before_Open_Lookup="@BeforeOpen_lookupDiscount" R_After_Open_Lookup="@AfterOpen_lookupDiscountAsync" TabIndex="2">...</R_Lookup>
            </R_ItemLayout>
            <R_ItemLayout>
                <R_TextBox @bind-Value="_agreementChrgDiscViewModel._discountName" Enabled="false"></R_TextBox>
            </R_ItemLayout>
        </R_StackLayout>

        @* discount type *@
        <R_StackLayout Row>
            <R_ItemLayout col="1">
                <R_Label>@_localizer["_labelDiscountType"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout></R_ItemLayout>
        </R_StackLayout>

        @* invoice period *@
        <R_StackLayout Row>
            <R_ItemLayout col="1">
                <R_Label>@_localizer["_labelInvoicePeriod"]</R_Label>
            </R_ItemLayout>
            <R_ItemLayout>
                <R_NumericTextBox @bind-Value="_agreementChrgDiscViewModel._yearPeriod" Arrows="true" OnChanged="OnChanged_YearPeriod"></R_NumericTextBox>
            </R_ItemLayout>
            <R_ItemLayout>
                <R_ComboBox Data="@_agreementChrgDiscViewModel._MonthPeriodList"
                            @bind-Value="@_agreementChrgDiscViewModel._AgreementChrgDiscProcessParam.CCHARGES_TYPE"
                            ValueField="@nameof(GSPeriodDT_DTO.CPERIOD_NO)"
                            TextField="@nameof(GSPeriodDT_DTO.CPERIOD_NO)" />
            </R_ItemLayout>
        
        </R_StackLayout>>

    </R_TabStripTab>

    <R_TabStripTab Title="@_localizer["_tabUndoDisc"]" Id="@nameof(PMT05001)">
        <R_TabPage @ref="@_tabUndoAgrChrgDisc"
                   R_Before_Open_TabPage="@BeforeOpenTabPage_Undo">
        </R_TabPage>
    </R_TabStripTab>
</R_TabStrip>